---
import { getUser, redirectUser } from '@astro-auth/core';
import CardTotalNumber from '@pattern/molecules/card/CardTotalNumber.svelte';
import CardWrapper from '@pattern/molecules/card/cardWrapper.svelte';
import Layout from '@layouts/Dashboard.astro';
import ServerStatusList from '@components/server/status/status-list.svelte';

const user = getUser({ client: Astro });
if (!user) {
  return redirectUser('/login');
}
---

<Layout title="Dashboard">
  <section class="mb-8">
    <h1 class="text-3xl font-bold">
      Hi, {user.first_name} ðŸ‘‹
      <small class="block text-base font-medium mt-2">Welcome back!</small>
    </h1>
  </section>
  <div class="space-y-8">
    <section class="grid grid-cols-2 lg:grid-cols-6 gap-4">
      <div
        un-bg="blue-50 dark:blue-800"
        class="p-4 rounded lt-lg:col-span-2 col-span-2 wrapper-status"
      >
        <ServerStatusList client:load />
      </div>
      <CardTotalNumber label="Users" number={20} />
      <CardTotalNumber label="Accounts" number={20} />
      <CardTotalNumber label="Characters" number={20} />
      <CardTotalNumber label="Guilds" number={20} />
    </section>
    <section class="grid lg:grid-cols-2 gap-4">
      <CardWrapper class="p-4 rounded">
        <h2 class="font-bold">New Users</h2>
      </CardWrapper>
      <CardWrapper class="p-4 rounded">
        <h2 class="font-bold">New Accounts</h2>
      </CardWrapper>
    </section>
  </div>
</Layout>

<style>
  .wrapper-status {
    @media (prefers-color-scheme: dark) {
      background: rgb(34,49,84);
      background: linear-gradient(49deg, rgba(34,49,84,1) 15%, rgba(34,59,117,1) 75%);
    }
  }
</style>
